import asyncio
from ai_processor import AIProcessor
from post_formatter import PostFormatter

async def test_improved():
    """Тестирует улучшенный анализ"""
    ai = AIProcessor()
    formatter = PostFormatter()
    
    # Реальные примеры сообщений из каналов
    test_messages = [
        "OZON: С 1 ноября изменяются правила модерации карточек товаров. Все карточки должны содержать видеообзоры",
        "Wildberries увеличивает комиссию для категории 'Электроника' с 5% до 7% с 15 ноября",
        "Яндекс Маркет запускает новую систему доставки за 2 часа в Москве и Санкт-Петербурге",
        "OZON Travel: новые направления для бронирования отелей в Турции и ОАЭ",
        "WB вводит обязательную маркировку для всех товаров категории 'Одежда'",
        "OZON Карта: увеличен кешбэк до 10% для постоянных покупателей",
        "Wildberries обновляет алгоритм выдачи товаров - приоритет отдается продавцам с высоким рейтингом",
        "Яндекс Доставка расширяет зону покрытия до 200 городов России",
        "OZON Marketplace: новые требования к описанию товаров - минимально 1000 символов",
        "WB: Изменения в политике возвратов - теперь возврат возможен в течение 45 дней"
    ]
    
    structured = ai.structure_content(test_messages, [])
    post = formatter.format_structured_post(structured)
    
    print("✅ Улучшенный пост:")
    print("\n" + "="*60)
    print(post)
    print("="*60)

if __name__ == "__main__":
    asyncio.run(test_improved())